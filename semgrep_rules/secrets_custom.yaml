rules:
  - id: securescan-hardcoded-password
    patterns:
      - pattern-either:
        - pattern: |
            $VAR = "..."
        - pattern: |
            $VAR: str = "..."
      - metavariable-regex:
          metavariable: $VAR
          regex: (?i)(password|passwd|pwd|secret_key|api_key|auth_token|access_token)
      - pattern-not: |
          $VAR = ""
      - pattern-not: |
          $VAR = "changeme"
      - pattern-not: |
          $VAR = os.environ[...]
      - pattern-not: |
          $VAR = os.getenv(...)
    message: >
      Variable '$VAR' appears to contain a hardcoded credential.
      Move this to environment variables or a secrets manager.
    severity: WARNING
    languages: [python]
    metadata:
      category: hardcoded-secret
      confidence: MEDIUM
